setwd("~/Documents/Books and Tutorials/Coursera/Introduction to Data Science/src/working copy/A5")
seaflow_21min <- read.csv("~/Documents/Books and Tutorials/Coursera/Introduction to Data Science/src/working copy/A5/seaflow_21min.csv", header=FALSE, stringsAsFactors=FALSE)
View(seaflow_21min)
seaflow_21min <- read.csv("~/Documents/Books and Tutorials/Coursera/Introduction to Data Science/src/working copy/A5/seaflow_21min.csv")
View(seaflow_21min)
summary(seaflow_21min$pop)
summary(seaflow_21min$fsc_small)
?createDataPartition
??createDataPartition
library(caret)
inTrain <- createDataPartition(seaflow_21min, times=1, p=0.5)
inTrain <- createDataPartition(seaflow_21min, times=1, p=0.5, list = FALSE)
inTrain <- createDataPartition(seaflow_21min$pop, times=1, p=0.5, list = FALSE)
train <- seaflow_21min[intrain, ]
test <- seaflow_21min[-intrain, ]
train <- seaflow_21min[inTrain, ]
test <- seaflow_21min[-inTrain, ]
summary(train$fsc_small)
summary(train$pop)
summary(test$pop)
summary(train$time)
summary(test$time)
summary(train$time)
str(train)
library(ggpplot2)
install.packages("ggplot2")
install.packages("ggplot2")
library(ggpplot2)
library(ggplot2)
install.packages("labeling")
qplot(pe, chl_small, data = seaflow, color=pop)
qplot(pe, chl_small, data = seaflow_21min, color=pop)
library(rpart)
model <- rpart(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, method="class", data=train)
print(model)
Prediction <- predict(model, test)
Prediction
Prediction[0:10]
View(Prediction)
View(Prediction)
View(test)
Prediction <- predict(model, test, type='class')
Prediction[1]
summary(Prediction == test$pop)
length(test)
View(test)
30947 + 5224
30947 / (30947 + 5224)
Prediction <- predict(model, test, type='class')
summary(Prediction == test$pop)
30947 / (30947 + 5224)
library(randomforest)
model <- randomForest(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, data=train)
Prediction <- predict(model, test, type='class')
summary(Prediction == test$pop)
library(randomForest)
model <- randomForest(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, data=train)
Prediction <- predict(model, test, type='class')
summary(Prediction == test$pop)
2828 /(2828 + 33343)
33343 /(2828 + 33343)
importance(model)
setwd("~/Documents/Books and Tutorials/Coursera/Introduction to Data Science/src/working copy/A5")
seaflow_21min <- read.csv("~/Documents/Books and Tutorials/Coursera/Introduction to Data Science/src/working copy/A5/seaflow_21min.csv")
summary(seaflow_21min$pop)
summary(seaflow_21min$fsc_small)
#??createDataPartition
library(caret)
inTrain <- createDataPartition(seaflow_21min$pop, times=1, p=0.5, list = FALSE)
train <- seaflow_21min[inTrain, ]
test <- seaflow_21min[-inTrain, ]
summary(train$time)
library(ggplot2)
qplot(pe, chl_small, data = seaflow_21min, color=pop)
library(rpart)
model <- rpart(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, method="class", data=train)
print(model)
Prediction <- predict(model, test, type='class')
summary(Prediction == test$pop)
30947 / (30947 + 5224)
library(randomForest)
model <- randomForest(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, data=train)
Prediction <- predict(model, test, type='class')
summary(Prediction == test$pop)
33343 /(2828 + 33343)
importance(model)
importance(model, type=2)
library(e1071)
install.libraries(e1071)
install.library(e1071)
install.packages("e1071")
install.packages("e1071")
library(e1071)
library('e1071')
model <- svm(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, data=train)
Prediction <- predict(model, test, type='class')
summary(Prediction == test$pop)
33261 / (33261 + 2910)
table(pred = Prediction, true = test$pop)
plot(c(1,2,3), c(1,2,4))
View(seaflow_21min)
plot(seaflow_21min$fsc_perp)
View(seaflow_21min)
plot(seaflow_21min$chl_big)
plot(seaflow_21min$chl_small)
plot(seaflow_21min$fsc_small)
plot(seaflow_21min$pe)
plot(seaflow_21min$fsc_big)
unique(seaflow_21min$fsc_big)
plot(seaflow_21min$chl_big)
plot(seaflow_21min$time, seaflow_21min$chl_big)
library(ggplot2)
p <- ggplot(seaflow_21min, aes(x = time, y = chl_big, colour = pop))
p + geom_point()
qplot(chl_big, data=df, geom="bar")
qplot(chl_big, data=seaflow_21min, geom="bar")
cleaned <- subset(seaflow_21min, file_id != 208)
View(cleaned)
summary(seaflow_21min$file_id)
table(seaflow_21min$file_id)
table(cleaned$file_id)
incleanedTrain <- createDataPartition(cleaned$pop, times=1, p=0.5, list = FALSE)
cleanedtrain <- seaflow_21min[incleanedTrain, ]
cleanedtest <- seaflow_21min[-incleanedTrain, ]
model <- svm(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, data=cleanedtrain)
Prediction <- predict(model, cleanedtest, type='class')
summary(Prediction == cleanedtest$pop)
38408 / (38408 + 3760)
33261 / (33261 + 2910)
(33261 / (33261 + 2910)) - (38408 / (38408 + 3760))
(38408 / (38408 + 3760)) - (33261 / (33261 + 2910))
38408 + 3760
cleaned <- subset(seaflow_21min, file_id != 208)
incleanedTrain <- createDataPartition(cleaned$pop, times=1, p=0.5, list = FALSE)
cleanedtrain <- seaflow_21min[incleanedTrain, ]
cleanedtest <- seaflow_21min[-incleanedTrain, ]
model <- svm(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, data=cleanedtrain)
Prediction <- predict(model, cleanedtest, type='class')
summary(Prediction == cleanedtest$pop)
38435 / (38435 +  3733)
(38435 / (38435 +  3733)) - (33261 / (33261 + 2910))
cleanedtrain <- subset(train, file_id != 208)
cleanedtest <- subset(test, file_id != 208)
model <- svm(pop ~ fsc_small + fsc_perp + fsc_big + pe + chl_big + chl_small, data=cleanedtrain)
Prediction <- predict(model, cleanedtest, type='class')
summary(Prediction == cleanedtest$pop)
29283 / (29283 +  860)
(29283 / (29283 +  860)) - (33261 / (33261 + 2910))
